<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Liuwei" />
        <meta name="copyright" content="Liuwei" />

<meta name="keywords" content="java, Java, " />
        <title>HttpSessionBinding接口  · Liuwei code
</title>
        <link href="http://cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
        <link href="http://liuwei.co/theme/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://liuwei.co/theme/css/style.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://liuwei.co/theme/css/solarizedlight.css" media="screen">
        <link rel="shortcut icon" href="http://liuwei.co/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="apple-touch-icon" href="http://liuwei.co/theme/images/apple-touch-icon.png" />
        <link rel="apple-touch-icon" sizes="57x57" href="http://liuwei.co/theme/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="http://liuwei.co/theme/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="http://liuwei.co/theme/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon" sizes="144x144" href="http://liuwei.co/theme/images/apple-touch-icon-144x144.png" />
        <link rel="icon" href="http://liuwei.co/theme/images/apple-touch-icon-144x144.png" />
        <link href="http://liuwei.co/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Liuwei code - Full Atom Feed" />
        <link href="http://liuwei.co/feeds/Android.atom.xml" type="application/atom+xml" rel="alternate" title="Liuwei code - Android Category Atom Feed" />
        <link href="http://liuwei.co/feeds/Java.atom.xml" type="application/atom+xml" rel="alternate" title="Liuwei code - Java Category Atom Feed" />
        <link href="http://liuwei.co/feeds/Linux.atom.xml" type="application/atom+xml" rel="alternate" title="Liuwei code - Linux Category Atom Feed" />
        <link href="http://liuwei.co/feeds/phonegap.atom.xml" type="application/atom+xml" rel="alternate" title="Liuwei code - phonegap Category Atom Feed" />
        <link href="http://liuwei.co/feeds/Ubuntu.atom.xml" type="application/atom+xml" rel="alternate" title="Liuwei code - Ubuntu Category Atom Feed" />
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://liuwei.co/"><span class=site-name>Liuwei code</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://liuwei.co">Home</a></li>
                            <li ><a href="http://liuwei.co/categories.html">Categories</a></li>
                            <li ><a href="http://liuwei.co/tags.html">Tags</a></li>
                            <li ><a href="http://liuwei.co/archives.html">Archives</a></li>
                            <li ><a href="http://liuwei.co/links.html">Links</a></li>
                            <li><form class="navbar-search" action="http://liuwei.co/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page_header span10 offset2">
    <h1><a href="http://liuwei.co/posts/2009/10/Introduce HttpSessionBinding Interface.html"> HttpSessionBinding接口  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <p>如果一个对象实现了HttpSessionBindingListener 接口，当这个对象被绑定到Session 中或者从Session 中
被删除的时候，Servlet容器会通知这个对象，而这个对象在接收到通知后，可以做一些初始化或者清除状态
的操作。</p>
<p>方法介绍 ：</p>
<p>javax.servlet.http.HttpSessionBindingListener 接口提供了下面的方法：</p>
<p>1、 public void valueBound(HttpSessionBindingEvent event)
当对象正在被绑定到Session 中，Servlet 容器调用该方法来通知该对象。</p>
<p>2、 public void valueUnbound(HttpSessionBindingEvent event)
当从Session 中删除对象时，Servlet 容器调用该方法来通知该对象。
Servlet 容器通过 HttpSessionBindingEvent 对象来通知实现了 HttpSessionBindingListener 接口的对象，而这个
对象可以利用HttpSessionBindingEvent 对象来访问与它相联系的HttpSession 对象.</p>
<p>javax.servlet.http.HttpSessionBindingEvent 类提供了一下两种方法：</p>
<p>public HttpSessionBindingEvent(HttpSession session, java.lang.String name)</p>
<p>public HttpSessionBindingEvent(HttpSession session, java.lang.String name,java.lang.Object value)</p>
<p>上面两个构造方法构造一个事件对象，当一个对象被绑定到Session 中或者从Session 中被删除的时候，用这
个事件对象来通知它。</p>
<p>public java.lang.String getName()
返回绑定到Session 中或者从Session 中被删除的属性的名字。</p>
<p>public java.lang.Object getValue()
返回被添加。删除或替换的属性的值，如果属性被添加或者被删除，这个方法返回属性的值，如果属性被替
换，这个方法返回属性先前的值。</p>
<p>public HttpSession getSession()
返回HttpSession 对象。</p>
<p>案例：在线人数统计程序</p>
<p>index.jsp</p>
<div class="highlight"><pre><span class="cp">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="n">language</span><span class="o">=</span><span class="err">”</span><span class="n">java</span><span class="err">”</span> <span class="n">import</span><span class="o">=</span><span class="err">”</span><span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">*</span><span class="err">”</span> <span class="n">pageEncoding</span><span class="o">=</span><span class="err">”</span><span class="no">GBK</span><span class="err">”</span><span class="cp">%&gt;</span>
<span class="cp">&lt;%</span>
<span class="nb">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">getContextPath</span><span class="p">();</span>
<span class="nb">String</span> <span class="n">basePath</span> <span class="o">=</span>
<span class="n">request</span><span class="o">.</span><span class="n">getScheme</span><span class="p">()</span><span class="o">+</span><span class="err">”</span><span class="ss">:/</span><span class="o">/</span><span class="err">”</span><span class="o">+</span><span class="n">request</span><span class="o">.</span><span class="n">getServerName</span><span class="p">()</span><span class="o">+</span><span class="err">”</span><span class="p">:</span><span class="err">”</span><span class="o">+</span><span class="n">request</span><span class="o">.</span><span class="n">getServerPort</span><span class="p">()</span><span class="o">+</span>
<span class="n">path</span><span class="o">+</span><span class="err">”</span><span class="o">/</span><span class="err">”</span><span class="p">;</span>
<span class="cp">%&gt;</span>
<span class="cp">&lt;!DOCTYPE HTML PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN”&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;base</span> <span class="na">href=</span><span class="s">”</span><span class="cp">&lt;%=</span><span class="n">basePath</span><span class="cp">%&gt;</span><span class="s">”</span><span class="nt">&gt;</span>
<span class="nt">&lt;title&gt;</span>My JSP ‘index.jsp’ starting page<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”pragma”</span> <span class="na">content=</span><span class="s">”no-cache”</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”cache-control”</span> <span class="na">content=</span><span class="s">”no-cache”</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”expires”</span> <span class="na">content=</span><span class="s">”0″</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”keywords”</span> <span class="na">content=</span><span class="s">”keyword1,keyword2,keyword3″</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”description”</span> <span class="na">content=</span><span class="s">”This</span> <span class="err">is</span> <span class="err">my</span> <span class="err">page”</span><span class="nt">&gt;</span>
<span class="cp">&lt;!–</span>
<span class="cp">&lt;link rel=”stylesheet” type=”text/css” href=”styles.css” mce_href=”styles.css”&gt;</span>
–&gt;
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">”CheckLogin”</span> <span class="na">method=</span><span class="s">”post”</span><span class="nt">&gt;</span>
<span class="nt">&lt;table&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td&gt;</span>用户名：<span class="nt">&lt;/td&gt;&lt;td&gt;&lt;input</span> <span class="na">type=</span><span class="s">”text”</span> <span class="na">name=</span><span class="s">”name”/</span><span class="nt">&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td&gt;</span>密码：<span class="nt">&lt;/td&gt;&lt;td&gt;&lt;input</span> <span class="na">type=</span><span class="s">”password”</span> <span class="na">name=</span><span class="s">”pass”/</span><span class="nt">&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td</span> <span class="na">colspan=</span><span class="s">”2″</span> <span class="na">align=</span><span class="s">”right”</span><span class="nt">&gt;&lt;input</span> <span class="na">type=</span><span class="s">”reset”</span> <span class="na">value=</span><span class="s">”</span> <span class="err">清</span> <span class="err">空</span>
<span class="err">“</span><span class="nt">/&gt;</span> <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">”submit”</span> <span class="na">value=</span><span class="s">”登陆”/</span><span class="nt">&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<p>CheckLogin.java</p>
<div class="highlight"><pre><span class="n">packagepackagepackagepackage</span> <span class="n">com</span><span class="p">.</span><span class="n">accp</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">servlet</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">IOException</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">ServletException</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpServlet</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpServletRequest</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpServletResponse</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpSession</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">com</span><span class="p">.</span><span class="n">accp</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">chatonline</span><span class="p">.</span><span class="n">User</span><span class="p">;</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">classclassclassclass</span> <span class="n">CheckLogin</span> <span class="n">extendsextendsextendsextends</span> <span class="n">HttpServlet</span> <span class="p">{</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">voidvoidvoidvoid</span> <span class="n">doGet</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="p">)</span>
<span class="n">throwsthrowsthrowsthrows</span> <span class="n">ServletException</span><span class="p">,</span> <span class="n">IOException</span> <span class="p">{</span>
<span class="n">doPost</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">voidvoidvoidvoid</span> <span class="n">doPost</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="p">)</span>
<span class="n">throwsthrowsthrowsthrows</span> <span class="n">ServletException</span><span class="p">,</span> <span class="n">IOException</span> <span class="p">{</span>
<span class="n">request</span><span class="p">.</span><span class="n">setCharacterEncoding</span><span class="p">(</span><span class="err">“</span><span class="n">GBK</span><span class="err">”</span><span class="p">);</span>
<span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="err">“</span><span class="n">name</span><span class="err">”</span><span class="p">);</span>
<span class="n">String</span> <span class="n">pass</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="err">“</span><span class="n">pass</span><span class="err">”</span><span class="p">);</span>
<span class="n">ifififif</span> <span class="p">(</span><span class="n">nullnullnullnull</span> <span class="o">==</span> <span class="n">name</span> <span class="o">||</span> <span class="n">pass</span><span class="o">==</span><span class="n">nullnullnullnull</span><span class="p">)</span> <span class="p">{</span>
<span class="n">request</span><span class="p">.</span><span class="n">getRequestDispatcher</span><span class="p">(</span><span class="err">“</span><span class="n">index</span><span class="p">.</span><span class="n">jsp</span><span class="err">”</span><span class="p">)</span>
<span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">);</span>
<span class="n">returnreturnreturnreturn</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">HttpSession</span> <span class="n">session</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">getSession</span><span class="p">();</span>
<span class="n">session</span><span class="p">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="p">,</span> <span class="n">newnewnewnew</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">));</span>
<span class="n">response</span><span class="p">.</span><span class="n">sendRedirect</span><span class="p">(</span><span class="err">“</span><span class="n">userlist</span><span class="p">.</span><span class="n">jsp</span><span class="err">”</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>User.java</p>
<div class="highlight"><pre><span class="n">packagepackagepackagepackage</span> <span class="n">com</span><span class="p">.</span><span class="n">accp</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">chatonline</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpSessionBindingEvent</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpSessionBindingListener</span><span class="p">;</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">classclassclassclass</span> <span class="n">User</span> <span class="n">implementsimplementsimplementsimplements</span> <span class="n">HttpSessionBindingListener</span> <span class="p">{</span>
<span class="n">privateprivateprivateprivate</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>
<span class="n">privateprivateprivateprivate</span> <span class="n">UserList</span> <span class="n">userList</span> <span class="o">=</span> <span class="n">UserList</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
<span class="n">publicpublicpublicpublic</span> <span class="nf">User</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
<span class="n">publicpublicpublicpublic</span> <span class="nf">User</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
<span class="n">thisthisthisthis</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span>
<span class="n">returnreturnreturnreturn</span> <span class="n">name</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">voidvoidvoidvoid</span> <span class="nf">setName</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
<span class="n">thisthisthisthis</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">voidvoidvoidvoid</span> <span class="nf">valueBound</span><span class="p">(</span><span class="n">HttpSessionBindingEvent</span> <span class="n">arg0</span><span class="p">)</span> <span class="p">{</span>
<span class="n">userList</span><span class="p">.</span><span class="n">addUser</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">voidvoidvoidvoid</span> <span class="nf">valueUnbound</span><span class="p">(</span><span class="n">HttpSessionBindingEvent</span> <span class="n">arg0</span><span class="p">)</span> <span class="p">{</span>
<span class="n">userList</span><span class="p">.</span><span class="n">removeUser</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>UserList.java</p>
<div class="highlight"><pre><span class="nx">packagepackagepackagepackage</span> <span class="nx">com.accp.demo.chatonline</span><span class="p">;</span>
<span class="nx">importimportimportimport</span> <span class="nx">java.util.Enumeration</span><span class="p">;</span>
<span class="nx">importimportimportimport</span> <span class="nx">java.util.Vector</span><span class="p">;</span>
<span class="cm">/**</span>
<span class="cm">* 单例类</span>
<span class="cm">* 统计在线人数</span>
<span class="cm">*@author@author@author@author 刘伟</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="nx">publicpublicpublicpublic</span> <span class="nx">classclassclassclass</span> <span class="nx">UserList</span> <span class="p">{</span>
<span class="nx">privateprivateprivateprivate</span> <span class="nx">staticstaticstaticstatic</span> <span class="nx">finalfinalfinalfinal</span> <span class="nx">UserList</span> <span class="n">userList</span><span class="o">=</span><span class="nx">newnewnewnew</span> <span class="nx">UserList</span><span class="p">();</span>
<span class="nx">privateprivateprivateprivate</span> <span class="nx">Vector</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="nx">v</span><span class="p">;</span>
<span class="c1">//私有的构造方法</span>
<span class="nx">privateprivateprivateprivate</span> <span class="nx">UserList</span><span class="p">(){</span>
<span class="n">v</span><span class="o">=</span><span class="nx">newnewnewnew</span> <span class="nx">Vector</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">();</span>
<span class="p">}</span>
<span class="c1">//获得实例</span>
<span class="nx">publicpublicpublicpublic</span> <span class="nx">staticstaticstaticstatic</span> <span class="nx">UserList</span> <span class="nx">getInstance</span><span class="p">(){</span>
<span class="nx">returnreturnreturnreturn</span> <span class="nx">userList</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">publicpublicpublicpublic</span> <span class="nx">voidvoidvoidvoid</span> <span class="nb">addUser</span><span class="p">(</span><span class="kt">String</span> <span class="nb">name</span><span class="p">){</span>
<span class="nx">ifififif</span><span class="p">(</span><span class="nx">nullnullnullnull</span><span class="o">!=</span><span class="nb">name</span><span class="p">){</span>
<span class="nx">v.add</span><span class="p">(</span><span class="nb">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nx">publicpublicpublicpublic</span> <span class="nx">voidvoidvoidvoid</span> <span class="nb">removeUser</span><span class="p">(</span><span class="kt">String</span> <span class="nb">name</span><span class="p">){</span>
<span class="nx">ifififif</span><span class="p">(</span><span class="nx">nullnullnullnull</span><span class="o">!=</span><span class="nb">name</span><span class="p">){</span>
<span class="nx">v.remove</span><span class="p">(</span><span class="nb">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="nx">publicpublicpublicpublic</span> <span class="nx">Enumeration</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span> <span class="nx">getUserList</span><span class="p">(){</span>
<span class="nx">returnreturnreturnreturn</span> <span class="nx">v.elements</span><span class="p">();</span>
<span class="p">}</span>
<span class="nx">publicpublicpublicpublic</span> <span class="nx">intintintint</span> <span class="nx">getUserCount</span><span class="p">(){</span>
<span class="nx">returnreturnreturnreturn</span> <span class="nx">v.size</span><span class="p">();</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Userlist.jsp</p>
<div class="highlight"><pre><span class="cp">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="n">language</span><span class="o">=</span><span class="err">”</span><span class="n">java</span><span class="err">”</span> <span class="n">import</span><span class="o">=</span><span class="err">”</span><span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">*</span><span class="err">”</span> <span class="n">pageEncoding</span><span class="o">=</span><span class="err">”</span><span class="no">GBK</span><span class="err">”</span><span class="cp">%&gt;</span>
<span class="cp">&lt;%</span><span class="vi">@page</span> <span class="n">import</span><span class="o">=</span><span class="err">”</span><span class="n">com</span><span class="o">.</span><span class="n">accp</span><span class="o">.</span><span class="n">demo</span><span class="o">.</span><span class="n">chatonline</span><span class="o">.</span><span class="n">UserList</span><span class="err">”</span><span class="cp">%&gt;</span>
<span class="cp">&lt;%</span>
<span class="nb">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">getContextPath</span><span class="p">();</span>
<span class="nb">String</span> <span class="n">basePath</span> <span class="o">=</span>
<span class="n">request</span><span class="o">.</span><span class="n">getScheme</span><span class="p">()</span><span class="o">+</span><span class="err">”</span><span class="ss">:/</span><span class="o">/</span><span class="err">”</span><span class="o">+</span><span class="n">request</span><span class="o">.</span><span class="n">getServerName</span><span class="p">()</span><span class="o">+</span><span class="err">”</span><span class="p">:</span><span class="err">”</span><span class="o">+</span><span class="n">request</span><span class="o">.</span><span class="n">getServerPort</span><span class="p">()</span><span class="o">+</span>
<span class="n">path</span><span class="o">+</span><span class="err">”</span><span class="o">/</span><span class="err">”</span><span class="p">;</span>
<span class="cp">%&gt;</span>
<span class="cp">&lt;!DOCTYPE HTML PUBLIC “-//W3C//DTD HTML 4.01 Transitional//EN”&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;base</span> <span class="na">href=</span><span class="s">”</span><span class="cp">&lt;%=</span><span class="n">basePath</span><span class="cp">%&gt;</span><span class="s">”</span><span class="nt">&gt;</span>
<span class="nt">&lt;title&gt;</span>My JSP ‘userlist.jsp’ starting page<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”pragma”</span> <span class="na">content=</span><span class="s">”no-cache”</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”cache-control”</span> <span class="na">content=</span><span class="s">”no-cache”</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”expires”</span> <span class="na">content=</span><span class="s">”0″</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”keywords”</span> <span class="na">content=</span><span class="s">”keyword1,keyword2,keyword3″</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">”description”</span> <span class="na">content=</span><span class="s">”This</span> <span class="err">is</span> <span class="err">my</span> <span class="err">page”</span><span class="nt">&gt;</span>
<span class="cp">&lt;!–</span>
<span class="cp">&lt;link rel=”stylesheet” type=”text/css” href=”styles.css” mce_href=”styles.css”&gt;</span>
–&gt;
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="cp">&lt;%</span>
<span class="no">UserList</span> <span class="n">ul</span><span class="o">=</span><span class="no">UserList</span><span class="o">.</span><span class="n">getInstance</span><span class="p">();</span>
<span class="no">Enumeration</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span> <span class="n">e</span><span class="o">=</span><span class="n">ul</span><span class="o">.</span><span class="n">getUserList</span><span class="p">();</span>
<span class="n">out</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="err">“当前在线用户：</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span><span class="err">”</span><span class="p">);</span>
<span class="n">whilewhilewhilewhile</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">hasMoreElements</span><span class="p">()){</span>
<span class="n">out</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">nextElement</span><span class="p">()</span><span class="o">+</span><span class="err">”</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span><span class="err">”</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">%&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">”servlet/LoginOut”</span> <span class="na">mce_href=</span><span class="s">”servlet/LoginOut”</span><span class="nt">&gt;</span>注销<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>


<p>LoginOut.java</p>
<div class="highlight"><pre><span class="n">packagepackagepackagepackage</span> <span class="n">com</span><span class="p">.</span><span class="n">accp</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">servlet</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">IOException</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">PrintWriter</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">ServletException</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpServlet</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpServletRequest</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpServletResponse</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">HttpSession</span><span class="p">;</span>
<span class="n">importimportimportimport</span> <span class="n">com</span><span class="p">.</span><span class="n">accp</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">chatonline</span><span class="p">.</span><span class="n">User</span><span class="p">;</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">classclassclassclass</span> <span class="n">LoginOut</span> <span class="n">extendsextendsextendsextends</span> <span class="n">HttpServlet</span> <span class="p">{</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">voidvoidvoidvoid</span> <span class="n">doGet</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="p">)</span>
<span class="n">throwsthrowsthrowsthrows</span> <span class="n">ServletException</span><span class="p">,</span> <span class="n">IOException</span> <span class="p">{</span>
<span class="n">HttpSession</span> <span class="n">session</span><span class="o">=</span><span class="n">request</span><span class="p">.</span><span class="n">getSession</span><span class="p">();</span>
<span class="n">String</span> <span class="n">name</span><span class="o">=</span><span class="p">((</span><span class="n">User</span><span class="p">)</span><span class="n">session</span><span class="p">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="p">)).</span><span class="n">getName</span><span class="p">();</span>
<span class="n">session</span><span class="p">.</span><span class="n">invalidate</span><span class="p">();</span>
<span class="n">response</span><span class="p">.</span><span class="n">setContentType</span><span class="p">(</span><span class="err">“</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="n">charset</span><span class="o">=</span><span class="n">GBK</span><span class="err">”</span><span class="p">);</span>
<span class="n">response</span><span class="p">.</span><span class="n">getWriter</span><span class="p">().</span><span class="n">print</span><span class="p">(</span><span class="err">“</span><span class="o">&lt;</span><span class="n">mce</span><span class="o">:</span><span class="n">script</span>
<span class="n">language</span><span class="o">=</span><span class="err">’</span><span class="n">javascript</span><span class="err">’</span><span class="o">&gt;&lt;!</span><span class="err">–</span>
<span class="n">alert</span><span class="p">(</span><span class="err">‘”</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="err">”</span> <span class="err">用</span> <span class="err">户</span> <span class="err">已</span> <span class="err">退</span> <span class="err">出</span>
<span class="err">‘</span><span class="p">);</span><span class="n">location</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="err">‘</span><span class="p">..</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">jsp</span><span class="err">’</span><span class="p">);</span>
<span class="c1">// –&gt;&lt;/mce:script&gt;”);</span>
<span class="p">}</span>
<span class="n">publicpublicpublicpublic</span> <span class="n">voidvoidvoidvoid</span> <span class="n">doPost</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="p">)</span>
<span class="n">throwsthrowsthrowsthrows</span> <span class="n">ServletException</span><span class="p">,</span> <span class="n">IOException</span> <span class="p">{</span>
<span class="n">doGet</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>web.xml</p>
<div class="highlight"><pre><span class="cp">&lt;?xml version=”1.0″ encoding=”UTF-8″?&gt;</span>
<span class="nt">&lt;web-app</span> <span class="na">version=</span><span class="s">”2.5″</span>
<span class="na">xmlns=</span><span class="s">”http://java.sun.com/xml/ns/javaee”</span>
<span class="na">xmlns:xsi=</span><span class="s">”http://www.w3.org/2001/XMLSchema-instance”</span>
<span class="na">xsi:schemaLocation=</span><span class="s">”http://java.sun.com/xml/ns/javaee</span>
<span class="err">http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd”</span><span class="nt">&gt;</span>
<span class="nt">&lt;servlet&gt;</span>
<span class="nt">&lt;servlet-name&gt;</span>CheckLogin<span class="nt">&lt;/servlet-name&gt;</span>
<span class="nt">&lt;servlet-class&gt;</span>com.accp.demo.servlet.CheckLogin<span class="nt">&lt;/servlet-class&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>
<span class="nt">&lt;servlet&gt;</span>
<span class="nt">&lt;servlet-name&gt;</span>LoginOut<span class="nt">&lt;/servlet-name&gt;</span>
<span class="nt">&lt;servlet-class&gt;</span>com.accp.demo.servlet.LoginOut<span class="nt">&lt;/servlet-class&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>
<span class="nt">&lt;servlet-mapping&gt;</span>
<span class="nt">&lt;servlet-name&gt;</span>CheckLogin<span class="nt">&lt;/servlet-name&gt;</span>
<span class="nt">&lt;url-pattern&gt;</span>/CheckLogin<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/servlet-mapping&gt;</span>
<span class="nt">&lt;servlet-mapping&gt;</span>
<span class="nt">&lt;servlet-name&gt;</span>LoginOut<span class="nt">&lt;/servlet-name&gt;</span>
<span class="nt">&lt;url-pattern&gt;</span>/servlet/LoginOut<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/servlet-mapping&gt;</span>
<span class="nt">&lt;welcome-file-list&gt;</span>
<span class="nt">&lt;welcome-file&gt;</span>index.jsp<span class="nt">&lt;/welcome-file&gt;</span>
<span class="nt">&lt;/welcome-file-list&gt;</span>
<span class="nt">&lt;/web-app&gt;</span>
</pre></div>
<!--  -->
<section>
<!-- <div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2"
                href="http://liuwei.co/posts/2009/10/Introduce HttpSessionBinding Interface.html#disqus_thread">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="accordion-body collapse">
            <div class="accordion-inner">
                <div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'suibian';
        var disqus_identifier = 'http://liuwei.co/posts/2009/10/Introduce HttpSessionBinding Interface.html';
    var disqus_url = 'http://liuwei.co/posts/2009/10/Introduce HttpSessionBinding Interface.html';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>                </div>
            </div>
        </div>
    </div>
</div> -->

<!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="Introduce HttpSessionBinding Interface" data-title="HttpSessionBinding接口" data-url="http://liuwei.co/posts/2009/10/Introduce HttpSessionBinding Interface.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"liuweicode"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
<!-- 多说公共JS代码 end -->

</section>
<!--  -->            <aside>
            <hr/>
            <nav>
            <ul class="articles_timeline">
 
                <li class="next_article"><a href="http://liuwei.co/posts/2009/10/the difference between forward and redirect.html" title="Next: 转发(Forward)和重定向(Redirect)的区别与总结">转发(Forward)和重定向(Redirect)的区别与总结</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
 
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2009-10-03T11:55:00">Oct 3, 2009</time>
            <h4>Category</h4>
            <a class="category-link" href="/categories.html#Java-ref">Java</a> 
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article"> 
                <li><a href="/tags.html#java-ref">java
                    <span>4</span>
</a></li>
            </ul>

        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://liuwei.co/theme/tipuesearch/jquery-2.1.0.min.js"></script>
        <script src="http://liuwei.co/theme/tipuesearch/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

<script type="text/javascript">
    var disqus_shortname = 'suibian';

    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
        <script  language="javascript" type="text/javascript">
            function uncollapse() {
                var hash_str = window.location.hash;
                if (window.location.hash.match(/^#comment-\d+$/))
                {
                    var hash_str = '#disqus_thread';
                }
                $(hash_str).collapse({
                    toggle: true
                    })
            }
        </script>

        <script type="text/javascript" language="JavaScript">
            uncollapse(); 
        </script>
    </body>
</html>